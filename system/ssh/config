# Include Colima SSH configuration if it exists
Include ~/.colima/ssh_config

# Work-machine local overrides
Include ~/.ssh/config.local

# ─────────────────────────────────────────────────────────────
# Personal machines on Tailscale (MagicDNS names)
Host lucky
    HostName lucky
    IdentitiesOnly yes
    IdentityFile ~/.ssh/id_personal

Host dreams
    HostName dreams
    IdentitiesOnly yes
    IdentityFile ~/.ssh/id_personal

Host draco
    HostName draco
    IdentitiesOnly yes
    IdentityFile ~/.ssh/id_personal

# Non-Tailscale personal box
Host mini-serv
    HostName 192.168.0.19
    # Allow password fallback ONLY here (client side)
    PreferredAuthentications publickey,password
    PasswordAuthentication yes
    IdentitiesOnly no

# Work machine (now on Tailscale)
Host swavesec
    HostName swavesec
    User e195761
    IdentitiesOnly yes
    IdentityFile ~/.ssh/id_work

# ─────────────────────────────────────────────────────────────
# Global defaults for all SSH connections (safe, fast)
Host *
    User stef
    Port 22
    IdentityFile ~/.ssh/id_personal
    AddKeysToAgent yes
    UseKeychain yes
    PreferredAuthentications publickey
    PasswordAuthentication no

    # Reliability
    ServerAliveInterval 60
    ServerAliveCountMax 10
    TCPKeepAlive yes
    Compression yes

    # Security settings
    GSSAPIAuthentication no       # Skip Kerberos auth (faster)
    HashKnownHosts yes            # Obfuscate known_hosts entries
    StrictHostKeyChecking ask     # Prompt before trusting new hosts
    UpdateHostKeys yes            # Auto-update host keys when legitimately changed